---
title: "Satena version 1.4.0"
description: "新機能の紹介"
tags: ["Android","Satena","はてなブックマーク"]
date: 2020-09-08T16:00:00+09:00
lastmod: 2020-09-08T16:00:00+09:00
archives:
    - 2020
    - 2020-09
    - 2020-09-08
hide_overview: false
draft: false
---

{{<AndroidApp_Satena>}}

## 新機能

{{<img src="new_entries_activity.png" zoom=".5" title="エントリ一覧画面の変更">}}

エントリ一覧画面。  
ボトムバーメニューの項目をカスタマイズできるようにしました。また、右に寄せて表示できるようにしました。(v1.3のように左に寄せる設定にもできます)

{{<img src="new_bookmarks_activity.png" zoom=".5" title="ブクマ一覧画面の変更">}}

ブクマ一覧画面。  
この画面でスターを付けられるようにしました(各項目右下"☆+")  
既にスターをつけたブコメは"★+"と塗りつぶされた星が表示されるようにしてあります。

### ■ボトムバーの項目をカスタマイズできるようにした

{{<img src="prefs_for_bottom_items.png" zoom=".85" title="ボトムバーに関する新しい設定項目">}}  {{<img src="bottom_items_selection.png" zoom=".5" title="ボトムメニュー項目を選択するダイアログ">}}

いくつか用意したショートカットから任意のものをユーザーが配置できるようにしました。

メニュー部分の幅から計算した配置可能ボタン数から、カテゴリによって追加される項目の最大数(2)を差し引いた個数までを設定することができます。

### ■ボトムバーの項目の位置を右寄せにもできるようにした

左寄せor右寄せを選択できます。

### ■カテゴリによって追加されるボトムバー項目の追加位置を設定できるようにした

- 各カテゴリの特集選択ボタン
- 「マイブックマーク」カテゴリの検索ボタン・タグ選択ボタン
- 「検索」カテゴリの検索対象指定ボタン
- 「タイムカプセル」カテゴリの表示対象指定ボタン

これらをボトムバーの右側に挿入するか左側に挿入するかを設定できるようにしました。  
```「デフォルト」```を選択すると、メニューが右寄せなら左側、メニューが左寄せなら右側に挿入されるようになります。

### ■エントリを素早く複数回タップしたときの挙動を設定できるようにした

{{<img src="prefs_for_multi_tap.png" zoom=".85" title="複数回タップに関する設定">}}

エントリリストの項目をトントンと素早く2回以上タップしたときの処理を新たに設定できるようにしました。  
タップ数ごとに処理を設定できるわけではなく、一定時間以内に2回でも3回でもとにかく複数回タップされたかどうかを判別します。

「短時間に何回タップされたか」を判定する時間を```0~500ミリ秒```の範囲で設定できます。(デフォルト: ```250ミリ秒```)  
複数回タップ判定機能をつけることで必然的にシングルタップをしてから処理が実行されるまでの間に待ち時間が発生するようになったため、そのもたつきが気になる場合はこの値を小さく設定することで違和感が少なくなるかもしれません。  
「***複数回タップなんて要らないからもたつかせるな***」という場合には、この値を```0ミリ秒```に設定しておけばv1.3までのタイムラグがないシングルタップ・ロングタップだけの処理方法に戻ります。

### ■各タップ時動作の選択肢に「何もしない」を追加

前の項目で紹介したタップ回数判定時間の無効化方法を使用すると、エントリを複数回タップした場合にはv1.3まで同様にシングルタップ時の処理が実行されます。  
一方、タップ回数判定時間を```0ミリ秒```に設定しないで```「複数回タップ時の動作」```に```「何もしない」```を設定すると複数回タップを検知した際には何も起こらなくなります。

### ■ブクマ一覧画面でスターをつけられるようにした

{{<img src="post_star_popup.png" zoom=".5" title="スター付与ポップアップ">}}

サインイン済みの状態であれば、コメントがあるブクマの右下に"☆+"ボタンが表示されます。  
これを押すと付与するスターを選択するポップアップが表示されます。  
スターを選択すると、「スターをつける前に確認する」設定がONになっている場合はさらに確認ダイアログが表示され、OFFの場合は即座にスターが付与されます。

所持していないカラースターのところはスターの代わりにカートが表示され、これをタップするとはてな公式のカラースターショップがブラウザで開かれます。

### ■自分がつけたスターを削除できるようにした

{{<img src="bookmark_menu.png" zoom=".85" title="ブクマメニューにスター削除を追加">}} {{<img src="delete_star_dialog.png" zoom=".85" title="スター削除ダイアログ">}}

取り消すスターの色を選択したら、その色のスターはすべて取り消されます。  
一個ずつの削除機能は今のところ用意していません。

#### ブクマ一覧画面

- スター付与済みの(内側が塗りつぶされた)"★+"ボタンを長押しするか、ブクマの長押しメニューからスター削除ダイアログが表示できます

#### ブクマ詳細画面

- 詳細表示しているブクマ(\*)につけられたスターリスト("★ to USER")タブでは、自分の項目の長押しメニューからブクマ(\*)へのスターを取り消せます

- 詳細表示しているブクマが自分のブクマの場合、"★ from USER"タブに表示されている「自分がスターをつけたブクマ」のスターを取り消せます

- メンション系のタブでは、そのリスト項目にスターをつけている場合それを取り消せます

### ■「カスタム」タブに必要に応じて「続きを読み込む」ボタンを表示するようにした

今までは初期状態で表示対象の項目が少ないとスクロールできないため追加分の取得ができませんでした。  
そのため「続きを読み込む」ボタンをフッタに表示するようにして、手動で更新を指示できるようにしました。  
このボタンは一度押すと最低1件以上表示対象のブクマが得られるまで読み込みを繰り返します。(関連→次項目)

### ■「カスタム」タブの追加更新時に表示対象が見つかるまでロードを繰り返すようにした

見つからない場合は最後まで取得し終えたら処理を終了します。

ブクマ数に応じてちょっと無視できないくらいには処理時間が長くなるので、今後どうするか検討中です。

### ■各部の色を調整した

最も大きく変わったのはエントリ画面のブクマ数表示部分でしょうか。  
他にはタブ&ボトムバーの背景色、スターの色、グレーの文字色を調整しました。

### ■「マイホットエントリ」カテゴリのアイコンを変えた

ずっと仮置きの「マイブックマーク」と同じアイコンのままだったので、別のものに差し替えました。

### ■「マイブックマーク」「検索」カテゴリの検索ボックスの変更

{{<img src="bottom_search_view.png" zoom=".5" title="ボトムバーのさらに下に表示する">}}

ボトムメニューの項目をカスタマイズできるようにした都合で、検索ボックスをボトムバー内部から外側に切り離しました。

### ■「タイムカプセル」カテゴリのドロップダウンメニューの変更

{{<img src="memorial_15th_bottom_menu.png" zoom=".85" title="ボトムバーではアイコン化">}}

ボトムバーを使用する場合には、「はてなの歴史」「あなたの歴史」を選択するドロップダウンメニューをアイコン表示するように変更しました。
